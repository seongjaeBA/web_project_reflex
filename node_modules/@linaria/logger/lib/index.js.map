{"version":3,"file":"index.js","names":["levels","currentLevel","indexOf","process","env","LINARIA_LOG","linariaLogger","genericDebug","loggers","Map","gerOrCreate","namespace","lastIndexOf","has","set","substr","extend","get","formatters","r","ref","color","parseInt","colorCode","text","f","fn","JSON","stringify","format","replace","log","level","namespaces","template","restArgs","logger","enabled","debug","bind","info","warn","error","notify","message","console","pc","red","s","italic","substring","length","padStart","num","len","toString","createCustomDebug","name","id","_args","arg1","args"],"sources":["../src/index.ts"],"sourcesContent":["import genericDebug from 'debug';\nimport type { Debugger } from 'debug';\nimport pc from 'picocolors';\n\ntype LogLevel = 'error' | 'warn' | 'info' | 'debug';\n\nconst levels = ['error', 'warn', 'info', 'debug'];\nconst currentLevel = levels.indexOf(process.env.LINARIA_LOG || 'warn');\n\nconst linariaLogger = genericDebug('linaria');\n\nconst loggers = new Map<string, Debugger>();\n\nfunction gerOrCreate(namespace: string | null | undefined): Debugger {\n  if (!namespace) return linariaLogger;\n  const lastIndexOf = namespace.lastIndexOf(':');\n  if (!loggers.has(namespace)) {\n    loggers.set(\n      namespace,\n      gerOrCreate(namespace.substr(0, lastIndexOf)).extend(\n        namespace.substr(lastIndexOf + 1)\n      )\n    );\n  }\n\n  return loggers.get(namespace)!;\n}\n\ngenericDebug.formatters.r = (ref: { namespace: string; text?: string }) => {\n  const color = parseInt(gerOrCreate(ref.namespace).color, 10);\n  const colorCode = `\\u001B[3${color < 8 ? color : `8;5;${color}`}`;\n  const text = ref.text ?? ref.namespace;\n  return `${colorCode};1m${text}\\u001B[0m`;\n};\n\ngenericDebug.formatters.f = function f(fn: () => unknown) {\n  return JSON.stringify(fn());\n};\n\nconst format = <T>(text: T) => {\n  if (typeof text === 'string') {\n    return text.replace(/\\n/g, '\\n\\t');\n  }\n\n  return text;\n};\n\nfunction log(\n  level: LogLevel,\n  namespaces: string,\n  template: unknown | (() => void),\n  ...restArgs: unknown[]\n) {\n  if (currentLevel < levels.indexOf(level)) {\n    return;\n  }\n\n  const logger = gerOrCreate(namespaces);\n  if (!logger.enabled) return;\n\n  if (typeof template === 'function') {\n    const text = template();\n    if (text) {\n      logger(format(text), ...restArgs);\n    }\n    return;\n  }\n\n  logger(format(template), ...restArgs);\n}\n\nexport const debug = log.bind(null, 'debug');\nexport const info = log.bind(null, 'info');\nexport const warn = log.bind(null, 'warn');\nexport const error = log.bind(null, 'error');\n\nexport const notify = (message: string) => {\n  // eslint-disable-next-line no-console\n  console.log(\n    pc.red(\n      message.replace(/(`.*?`)/g, (s) =>\n        pc.italic(s.substring(1, s.length - 1))\n      )\n    )\n  );\n};\n\nconst padStart = (num: number, len: number) =>\n  num.toString(10).padStart(len, '0');\n\nexport type CustomDebug = (\n  namespace: string,\n  template: string,\n  ...args: unknown[]\n) => void;\n\nexport function createCustomDebug(name: string, id: number): CustomDebug {\n  return (..._args: Parameters<typeof debug>) => {\n    const [namespace, arg1, ...args] = _args;\n    debug(`${name}:${padStart(id, 5)}`, `[${namespace}] ${arg1}`, ...args);\n  };\n}\n"],"mappings":";;;;;;;AAAA;AAEA;AAA4B;AAI5B,MAAMA,MAAM,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC;AACjD,MAAMC,YAAY,GAAGD,MAAM,CAACE,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,WAAW,IAAI,MAAM,CAAC;AAEtE,MAAMC,aAAa,GAAG,IAAAC,cAAY,EAAC,SAAS,CAAC;AAE7C,MAAMC,OAAO,GAAG,IAAIC,GAAG,EAAoB;AAE3C,SAASC,WAAW,CAACC,SAAoC,EAAY;EACnE,IAAI,CAACA,SAAS,EAAE,OAAOL,aAAa;EACpC,MAAMM,WAAW,GAAGD,SAAS,CAACC,WAAW,CAAC,GAAG,CAAC;EAC9C,IAAI,CAACJ,OAAO,CAACK,GAAG,CAACF,SAAS,CAAC,EAAE;IAC3BH,OAAO,CAACM,GAAG,CACTH,SAAS,EACTD,WAAW,CAACC,SAAS,CAACI,MAAM,CAAC,CAAC,EAAEH,WAAW,CAAC,CAAC,CAACI,MAAM,CAClDL,SAAS,CAACI,MAAM,CAACH,WAAW,GAAG,CAAC,CAAC,CAClC,CACF;EACH;EAEA,OAAOJ,OAAO,CAACS,GAAG,CAACN,SAAS,CAAC;AAC/B;AAEAJ,cAAY,CAACW,UAAU,CAACC,CAAC,GAAIC,GAAyC,IAAK;EAAA;EACzE,MAAMC,KAAK,GAAGC,QAAQ,CAACZ,WAAW,CAACU,GAAG,CAACT,SAAS,CAAC,CAACU,KAAK,EAAE,EAAE,CAAC;EAC5D,MAAME,SAAS,GAAI,WAAUF,KAAK,GAAG,CAAC,GAAGA,KAAK,GAAI,OAAMA,KAAM,EAAE,EAAC;EACjE,MAAMG,IAAI,gBAAGJ,GAAG,CAACI,IAAI,iDAAIJ,GAAG,CAACT,SAAS;EACtC,OAAQ,GAAEY,SAAU,MAAKC,IAAK,WAAU;AAC1C,CAAC;AAEDjB,cAAY,CAACW,UAAU,CAACO,CAAC,GAAG,SAASA,CAAC,CAACC,EAAiB,EAAE;EACxD,OAAOC,IAAI,CAACC,SAAS,CAACF,EAAE,EAAE,CAAC;AAC7B,CAAC;AAED,MAAMG,MAAM,GAAOL,IAAO,IAAK;EAC7B,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC5B,OAAOA,IAAI,CAACM,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC;EACpC;EAEA,OAAON,IAAI;AACb,CAAC;AAED,SAASO,GAAG,CACVC,KAAe,EACfC,UAAkB,EAClBC,QAAgC,EAChC,GAAGC,QAAmB,EACtB;EACA,IAAIlC,YAAY,GAAGD,MAAM,CAACE,OAAO,CAAC8B,KAAK,CAAC,EAAE;IACxC;EACF;EAEA,MAAMI,MAAM,GAAG1B,WAAW,CAACuB,UAAU,CAAC;EACtC,IAAI,CAACG,MAAM,CAACC,OAAO,EAAE;EAErB,IAAI,OAAOH,QAAQ,KAAK,UAAU,EAAE;IAClC,MAAMV,IAAI,GAAGU,QAAQ,EAAE;IACvB,IAAIV,IAAI,EAAE;MACRY,MAAM,CAACP,MAAM,CAACL,IAAI,CAAC,EAAE,GAAGW,QAAQ,CAAC;IACnC;IACA;EACF;EAEAC,MAAM,CAACP,MAAM,CAACK,QAAQ,CAAC,EAAE,GAAGC,QAAQ,CAAC;AACvC;AAEO,MAAMG,KAAK,GAAGP,GAAG,CAACQ,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC;AAAC;AACtC,MAAMC,IAAI,GAAGT,GAAG,CAACQ,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC;AAAC;AACpC,MAAME,IAAI,GAAGV,GAAG,CAACQ,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC;AAAC;AACpC,MAAMG,KAAK,GAAGX,GAAG,CAACQ,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC;AAAC;AAEtC,MAAMI,MAAM,GAAIC,OAAe,IAAK;EACzC;EACAC,OAAO,CAACd,GAAG,CACTe,mBAAE,CAACC,GAAG,CACJH,OAAO,CAACd,OAAO,CAAC,UAAU,EAAGkB,CAAC,IAC5BF,mBAAE,CAACG,MAAM,CAACD,CAAC,CAACE,SAAS,CAAC,CAAC,EAAEF,CAAC,CAACG,MAAM,GAAG,CAAC,CAAC,CAAC,CACxC,CACF,CACF;AACH,CAAC;AAAC;AAEF,MAAMC,QAAQ,GAAG,CAACC,GAAW,EAAEC,GAAW,KACxCD,GAAG,CAACE,QAAQ,CAAC,EAAE,CAAC,CAACH,QAAQ,CAACE,GAAG,EAAE,GAAG,CAAC;AAQ9B,SAASE,iBAAiB,CAACC,IAAY,EAAEC,EAAU,EAAe;EACvE,OAAO,CAAC,GAAGC,KAA+B,KAAK;IAC7C,MAAM,CAAChD,SAAS,EAAEiD,IAAI,EAAE,GAAGC,IAAI,CAAC,GAAGF,KAAK;IACxCrB,KAAK,CAAE,GAAEmB,IAAK,IAAGL,QAAQ,CAACM,EAAE,EAAE,CAAC,CAAE,EAAC,EAAG,IAAG/C,SAAU,KAAIiD,IAAK,EAAC,EAAE,GAAGC,IAAI,CAAC;EACxE,CAAC;AACH"}